package akhil.knoxrootbypass;


import java.lang.reflect.Method;

import de.robv.android.xposed.IXposedHookLoadPackage;
import de.robv.android.xposed.XposedBridge;
import de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;

import static de.robv.android.xposed.XC_MethodReplacement.returnConstant;
import static de.robv.android.xposed.XposedHelpers.findClass;


public class knoxRootBypass implements IXposedHookLoadPackage {

    public void handleLoadPackage(final LoadPackageParam lpparam) throws Throwable {
        if (!lpparam.packageName.equals("com.sds.mysinglesquare"))
            return;
        XposedBridge.log("Knox Bypass Root: " + lpparam.packageName);

        Class<?> appClass = findClass("com.sds.mysinglesquare.security.module.SecurityModuleImpl", lpparam.classLoader);
        Method[] getallmethods = appClass.getMethods();
        for (Method possibleMethod : getallmethods) {
            String methodName = possibleMethod.getName();
            if (methodName.equals("isRootingDevice")) {
                XposedBridge.log("Method found: " + methodName);
                XposedBridge.hookMethod(possibleMethod, returnConstant(false));
            }
        }
    }
}